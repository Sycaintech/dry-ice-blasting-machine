<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dry Ice Blasting Total Cost of Ownership (TCO) Calculator</title>
    <link rel="icon" href="favicon.png" type="image/png">
    <link rel="apple-touch-icon" href="favicon.png">
    <meta name="description" content="Discover our professional AI30 Dry Ice Blasting Machine. It provides an efficient, eco-friendly, and residue-free cleaning solution for automotive, food processing, and manufacturing industries. Buy it Now.">
    <meta name="keywords" content="dry ice blaster TCO">
    <meta name="robots" content="index, follow">
    <link rel="canonical" href="https://www.dry-ice-blasting-machine.com">

    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>

    <style>
        /* Smooth scroll effect for the page */
        html { scroll-behavior: smooth; }

        /* General page styles */
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            line-height: 1.6;
            color: #333;
            margin: 0;
            padding: 0;
            background-color: #f9f9f9;
        }

        /* Header and Navigation Styles */
        .main-header {
            background-color: #f9f9f9;
            padding: 15px 0;
            border-bottom: 1px solid #e0e0e0;
            width: 100%;
            position: sticky; /* Make the header sticky */
            top: 0; /* Stick to the top of the viewport */
            z-index: 1000; /* Ensure it stays on top of other content */
        }

        .nav-container {
            max-width: 900px;
            margin: 0 auto;
            padding: 0 20px;
            display: flex;
            justify-content: flex-start;
            align-items: center;
        }

        .home-button {
            background-color: #3f51b5; /* Match the 'Calculate' button color */
            color: #fff;
            padding: 8px 15px;
            border-radius: 5px;
            text-decoration: none;
            font-weight: bold;
            font-size: 0.9em;
            transition: background-color: 0.3s ease;
        }

        .home-button:hover {
            background-color: #303f9f; /* Match the 'Calculate' button hover color */
        }

        /* Main content wrapper */
        .main-content {
            max-width: 900px;
            margin: 20px auto;
            padding: 0 20px;
        }

        /* Main container styles */
        .container {
            background-color: #fff;
            padding: 25px;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            margin-bottom: 30px;
        }

        /* Header styles */
        h1, h2, h3 { color: #1a237e; border-bottom: 2px solid #3f51b5; padding-bottom: 10px; text-align: center; }
        h3 { border-bottom: none; text-align: left; }

        /* Form and input area styles */
        .calculator-form { display: grid; grid-template-columns: 1fr 1fr; gap: 20px 40px; margin-top: 20px; }
        .input-group { display: flex; flex-direction: column; }
        .fixed-cost-display { background-color: #f5f5f5; padding: 10px; border-radius: 5px; border: 1px solid #e0e0e0; }
        .fixed-cost-display .cost-value { font-size: 1.2em; font-weight: bold; color: #1a237e; margin-top: 4px; }
        label { font-weight: bold; margin-bottom: 5px; color: #555; }
        input, input::placeholder {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            font-size: 1em;
            color: #333;
        }
        input#compressorCost { /* Hide the range input visually in the PDF */
            -webkit-appearance: none;
            width: 100%;
            height: 10px;
            background: #d3d3d3;
            border-radius: 5px;
            outline: none;
            opacity: 0; /* Make it visually hidden in PDF */
            pointer-events: none; /* Ensure it doesn't interfere with clicks */
        }
        input#compressorCost::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 15px;
            height: 15px;
            background: #3f51b5;
            cursor: pointer;
            border-radius: 50%;
        }
        input#compressorCost::-moz-range-thumb {
            width: 15px;
            height: 15px;
            background: #3f51b5;
            cursor: pointer;
            border-radius: 50%;
            border: none;
        }
        input#hoursPerJob, input#jobsPerYear, input#dryIceCost, input#maintenanceCost {
            padding: 10px; border-radius: 5px; border: 1px solid #ccc; width: 100%; box-sizing: border-box;
        }
        .range-container { display: flex; align-items: center; gap: 10px; }
        .range-value { font-weight: bold; color: #3f51b5; min-width: 70px; text-align: right; }

        /* Button styles */
        .calculate-btn { grid-column: 1 / -1; padding: 12px 20px; font-size: 1.1em; font-weight: bold; color: #fff; background-color: #3f51b5; border: none; border-radius: 5px; cursor: pointer; transition: background-color 0.3s ease; margin-top: 20px; }
        .calculate-btn:hover { background-color: #303f9f; }

        /* Results display area styles */
        #results { margin-top: 30px; padding: 20px; background-color: #e8eaf6; border-radius: 8px; border-left: 5px solid #3f51b5; display: none; }
        .result-section { display: flex; justify-content: space-between; align-items: center; padding: 15px; margin: 10px 0; border-radius: 5px; }
        .professional-cost { background-color: #fff3e0; }
        .diy-cost { background-color: #e0f2f1; }
        .cost-title { font-weight: bold; font-size: 1.1em; }
        .cost-value { font-size: 1.5em; font-weight: bold; }
        #summary { margin-top: 20px; padding: 15px; font-size: 1.2em; text-align: center; border-radius: 5px; }
        .summary-cheaper { background-color: #c8e6c9; color: #1b5e20; }
        .summary-expensive { background-color: #ffcdd2; color: #b71c1c; }
        #recommendation-box { display: none; margin-top: 20px; padding: 20px; background-color: #e8f5e9; border: 1px solid #66bb6a; border-radius: 8px; text-align: center; }
        #recommendation-box p { font-size: 1.1em; color: #2e7d32; margin-top: 0; }
        .view-product-btn { display: inline-block; margin-top: 15px; padding: 10px 25px; font-size: 1em; font-weight: bold; color: #fff; background-color: #43a047; border-radius: 5px; text-decoration: none; transition: background-color: 0.3s ease; }
        .view-product-btn:hover { background-color: #388e3c; }

        /* New styles for Chart and PDF Button */
        #chart-container { padding: 20px 0; }
        canvas { max-width: 100%; }
        #savePdfBtn {
            display: none; /* Hidden by default */
            background-color: #2e7d32; /* Green color to stand out */
            width: 100%;
            margin-top: 20px;
        }
        #savePdfBtn:hover { background-color: #1b5e20; }

        /* Styles for PDF Watermark */
        .pdf-watermark {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) rotate(-45deg);
            font-size: 2em;
            color: #ccc;
            opacity: 0.5;
            width: 100%;
            text-align: center;
            z-index: -1; /* Ensure it's behind the content */
            pointer-events: none; /* Avoid interfering with content clicks */
        }

        /* Styles specifically for the PDF content */
        .pdf-content {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            line-height: 1.6;
            color: #333;
            padding: 20px;
        }
        .pdf-title { text-align: center; color: #1a237e; }
        .pdf-section-title { color: #3f51b5; border-bottom: 1px solid #e0e0e0; padding-bottom: 5px; margin-top: 15px; }
        .pdf-input-row { display: flex; justify-content: space-between; margin-bottom: 8px; }
        .pdf-label { font-weight: bold; width: 50%; }
        .pdf-value { width: 50%; text-align: right; }
        .pdf-result-section { display: flex; justify-content: space-between; padding: 10px 0; border-top: 1px solid #f0f0f0; }
        .pdf-cost-title { font-weight: bold; }
        .pdf-cost-value { font-weight: bold; }
        .pdf-summary { text-align: center; margin-top: 15px; font-style: italic; }
        .pdf-recommendation { text-align: center; margin-top: 15px; font-weight: bold; color: #2e7d32; }
        .pdf-chart-img { max-width: 100%; margin: 15px 0; }

        /* Hide the standard content when generating PDF */
        .generating-pdf .container { display: none; }
    </style>
</head>
<body>

<header class="main-header">
    <div class="nav-container">
        <a href="https://www.dry-ice-blasting-machine.com" class="home-button">Back to Home</a>
    </div>
</header>

<div class="main-content">
    <div class="container">
        <h1>Dry Ice Blasting Total Cost of Ownership (TCO) Calculator</h1>
        <p>Based on your project needs, enter the information below to compare the annual costs of "Hiring Professionals" versus "Buying Your Own Equipment".</p>

        <form id="tco-calculator" onsubmit="return false;">
            <h2>Step 1: Enter Your Project Information</h2>
            <div class="calculator-form">
                <div class="input-group">
                    <label for="hoursPerJob">Estimated Hours per Job</label>
                    <input type="number" id="hoursPerJob" value="8" min="1">
                </div>
                <div class="input-group">
                    <label for="jobsPerYear">Number of Jobs per Year</label>
                    <input type="number" id="jobsPerYear" value="12" min="1">
                </div>
            </div>

            <h2>Step 2: Adjust DIY Equipment & Consumable Costs</h2>
            <div class="calculator-form">
                <div class="input-group fixed-cost-display">
                    <label>AI30 Dry Ice Blaster Cost (Original price)</label>
                    <div class="cost-value">$3,099</div>
                </div>
                <div class="input-group">
                    <label for="compressorCost">Air Compressor Cost ($5,000 - $10,000)</label>
                    <div class="range-container">
                        <input type="range" id="compressorCost" min="5000" max="10000" step="500" value="5000">
                        <span class="range-value" id="compressorCostValue">$5,000</span>
                    </div>
                </div>
                <div class="input-group">
                    <label for="dryIceCost">Dry Ice Cost per Pound ($)</label>
                    <input type="number" id="dryIceCost" value="1.00" min="0.5" step="0.1">
                </div>
                <div class="input-group">
                    <label for="maintenanceCost">Annual Maintenance & Other Costs ($)</label>
                    <input type="number" id="maintenanceCost" value="250" min="0">
                </div>
            </div>

            <button type="button" class="calculate-btn" onclick="calculateTCO()">Calculate Annual Total Cost</button>
        </form>

        <div id="results">
            <h2>Cost Analysis Results</h2>

            <div id="chart-container">
                <canvas id="costChart"></canvas>
            </div>

            <div class="result-section professional-cost">
                <span class="cost-title">Hiring Professionals: Annual Total Cost</span>
                <span class="cost-value" id="professionalTotalCost"></span>
            </div>
            <div class="result-section diy-cost">
                <span class="cost-title">DIY: Annual Total Cost (Equipment + Operations)</span>
                <span class="cost-value" id="diyTotalCost"></span>
            </div>
            <div id="summary"></div>
            <div id="recommendation-box">
                <p><strong>Highly Recommended!</strong> Based on your usage frequency, purchasing your own blaster is a more economical and flexible long-term investment.</p>
                <a href="https://www.dry-ice-blasting-machine.com" class="view-product-btn">Learn More</a>
            </div>

            <button id="savePdfBtn" class="calculate-btn" onclick="saveAsPDF()">Save Results as PDF</button>
        </div>
    </div>
</div>

<script>
    // Global variable to hold the chart instance
    let myCostChart;

    // Helper to format numbers as USD currency
    const formatter = new Intl.NumberFormat('en-US', {
        style: 'currency', currency: 'USD', minimumFractionDigits: 0, maximumFractionDigits: 0,
    });

    // JS for the compressor cost slider
    const compressorCostSlider = document.getElementById('compressorCost');
    const compressorCostValue = document.getElementById('compressorCostValue');
    compressorCostSlider.oninput = function() { compressorCostValue.textContent = formatter.format(this.value); }

    // Manually update the slider's initial value display on page load
    document.addEventListener('DOMContentLoaded', () => {
        compressorCostValue.textContent = formatter.format(compressorCostSlider.value);
    });

    function calculateTCO() {
        // Get user inputs
        const hoursPerJob = parseFloat(document.getElementById('hoursPerJob').value) || 0;
        const jobsPerYear = parseFloat(document.getElementById('jobsPerYear').value) || 0;
        const compressorCost = parseFloat(document.getElementById('compressorCost').value) || 0;
        const dryIceCostPerPound = parseFloat(document.getElementById('dryIceCost').value) || 0;
        const maintenanceCost = parseFloat(document.getElementById('maintenanceCost').value) || 0;

        // Fixed costs and rates
        const machineCost = 3099; // Hardcoded machine cost
        const professionalHourlyRate = 395;
        const dryIceConsumptionPerMinute = 0.66;

        // Calculations
        const totalHoursPerYear = hoursPerJob * jobsPerYear;
        const professionalTotalCost = totalHoursPerYear * professionalHourlyRate;

        const upfrontCost = machineCost + compressorCost;
        const totalMinutesPerYear = totalHoursPerYear * 60;
        const totalDryIceNeeded = totalMinutesPerYear * dryIceConsumptionPerMinute;
        const annualDryIceCost = totalDryIceNeeded * dryIceCostPerPound;
        const annualOperationalCost = annualDryIceCost + maintenanceCost;
        const diyTotalCost = upfrontCost + annualOperationalCost;

        // Get elements for displaying results
        const resultsDiv = document.getElementById('results');
        const summaryDiv = document.getElementById('summary');
        const recommendationBox = document.getElementById('recommendation-box');
        const savePdfBtn = document.getElementById('savePdfBtn');

        // Display results on the page
        document.getElementById('professionalTotalCost').textContent = formatter.format(professionalTotalCost);
        document.getElementById('diyTotalCost').textContent = formatter.format(diyTotalCost);
        resultsDiv.style.display = 'block';
        savePdfBtn.style.display = 'block';

        // Generate summary and recommendation
        let summaryText = '';
        let recommendationText = '';
        if (diyTotalCost < professionalTotalCost) {
            const savings = professionalTotalCost - diyTotalCost;
            summaryText = `Conclusion: The <strong>DIY / Purchase Equipment</strong> option is more cost-effective in the first year, saving an estimated <strong>${formatter.format(savings)}</strong>.`;
            summaryDiv.className = 'summary-cheaper';
            recommendationBox.style.display = 'block';
            recommendationText = "Highly Recommended! Based on your usage frequency, purchasing your own blaster is a more economical and flexible long-term investment.";
        } else {
            const extraCost = diyTotalCost - professionalTotalCost;
            summaryText = `Conclusion: <strong>Hiring Professionals</strong> is more economical in the first year. The DIY option costs <strong>${formatter.format(extraCost)}</strong> more.`;
            summaryDiv.className = 'summary-expensive';
            recommendationBox.style.display = 'none';
            recommendationText = "";
        }
        summaryDiv.innerHTML = summaryText + "<br><small>Note: This calculation does not factor in personnel training, storage, or time costs. The long-term benefits of the DIY option may be greater.</small>";

        // Update or create the chart
        updateChart(professionalTotalCost, diyTotalCost);
    }

    /**
     * Creates or updates the BI chart with new data.
     * @param {number} professionalCost - The calculated annual cost of hiring professionals.
     * @param {number} diyCost - The calculated annual cost of buying and operating the equipment.
     */
    function updateChart(professionalCost, diyCost) {
        const ctx = document.getElementById('costChart').getContext('2d');

        if (myCostChart) {
            myCostChart.destroy();
        }

        myCostChart = new Chart(ctx, {
            type: 'bar',
            data: {
                labels: ['Hiring Professionals', 'DIY / Purchase Equipment'],
                datasets: [{
                    label: 'Annual Total Cost ($)',
                    data: [professionalCost, diyCost],
                    backgroundColor: [ 'rgba(255, 159, 64, 0.7)', 'rgba(75, 192, 192, 0.7)' ],
                    borderColor: [ 'rgba(255, 159, 64, 1)', 'rgba(75, 192, 192, 1)' ],
                    borderWidth: 1
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: true,
                plugins: {
                    legend: { display: false },
                    title: {
                        display: true,
                        text: 'Visual Cost Comparison (First Year)',
                        font: { size: 16 }
                    }
                },
                scales: {
                    y: {
                        beginAtZero: true,
                        ticks: {
                            callback: function(value) { return formatter.format(value); }
                        }
                    }
                }
            }
        });
    }

    /**
     * Generates an HTML string for the PDF content, including user inputs, results, and a watermark.
     */
    function getPdfContent() {
        const hoursPerJob = document.getElementById('hoursPerJob').value;
        const jobsPerYear = document.getElementById('jobsPerYear').value;
        const compressorCostValue = document.getElementById('compressorCostValue').textContent;
        const dryIceCost = document.getElementById('dryIceCost').value;
        const maintenanceCost = document.getElementById('maintenanceCost').value;
        const professionalTotalCost = document.getElementById('professionalTotalCost').textContent;
        const diyTotalCost = document.getElementById('diyTotalCost').textContent;
        const summaryText = document.getElementById('summary').innerHTML;
        const recommendationBox = document.getElementById('recommendation-box');
        const recommendationText = recommendationBox.style.display === 'block' ? recommendationBox.querySelector('p').textContent : '';
        const chartImageBase64 = myCostChart ? myCostChart.toBase64Image() : '';

        return `
            <!DOCTYPE html>
            <html lang="en">
            <head>
                <meta charset="UTF-8">
                <meta name="viewport" content="width=device-width, initial-scale=1.0">
                <title>TCO Analysis Results</title>
                <style>
                    .pdf-watermark {
                        position: fixed;
                        top: 50%;
                        left: 50%;
                        transform: translate(-50%, -50%) rotate(-45deg);
                        font-size: 2em;
                        color: #ccc;
                        opacity: 0.5;
                        width: 100%;
                        text-align: center;
                        z-index: -1;
                        pointer-events: none;
                    }
                    .pdf-content { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif; line-height: 1.6; color: #333; padding: 20px; }
                    .pdf-title { text-align: center; color: #1a237e; margin-bottom: 20px; }
                    .pdf-section-title { color: #3f51b5; border-bottom: 1px solid #e0e0e0; padding-bottom: 5px; margin-top: 15px; }
                    .pdf-input-row { display: flex; justify-content: space-between; margin-bottom: 8px; }
                    .pdf-label { font-weight: bold; width: 60%; }
                    .pdf-value { width: 40%; text-align: right; }
                    .pdf-result-section { display: flex; justify-content: space-between; padding: 10px 0; border-top: 1px solid #f0f0f0; }
                    .pdf-cost-title { font-weight: bold; }
                    .pdf-cost-value { font-weight: bold; }
                    .pdf-summary { text-align: center; margin-top: 15px; font-style: italic; }
                    .pdf-recommendation { text-align: center; margin-top: 15px; font-weight: bold; color: #2e7d32; }
                    .pdf-chart-img { max-width: 100%; margin: 15px 0; }
                </style>
            </head>
            <body>
                <div class="pdf-watermark">Data from https://www.dry-ice-blasting-machine.com/tco-calculator</div>
                <div class="pdf-content">
                    <h1 class="pdf-title">TCO Analysis Results</h1>
                    <div class="pdf-section-title">Project Information</div>
                    <div class="pdf-input-row"><div class="pdf-label">Estimated Hours per Job:</div><div class="pdf-value">${hoursPerJob}</div></div>
                    <div class="pdf-input-row"><div class="pdf-label">Number of Jobs per Year:</div><div class="pdf-value">${jobsPerYear}</div></div>
                    <div class="pdf-section-title">DIY Equipment & Consumable Costs</div>
                    <div class="pdf-input-row"><div class="pdf-label">AI30 Dry Ice Blaster Cost:</div><div class="pdf-value">$3,099</div></div>
                    <div class="pdf-input-row"><div class="pdf-label">Air Compressor Cost:</div><div class="pdf-value">${compressorCostValue}</div></div>
                    <div class="pdf-input-row"><div class="pdf-label">Dry Ice Cost per Pound:</div><div class="pdf-value">$${dryIceCost}</div></div>
                    <div class="pdf-input-row"><div class="pdf-label">Annual Maintenance & Other Costs:</div><div class="pdf-value">$${maintenanceCost}</div></div>
                    <div class="pdf-section-title">Cost Analysis</div>
                    ${chartImageBase64 ? `<img src="${chartImageBase64}" alt="Cost Comparison Chart" class="pdf-chart-img">` : ''}
                    <div class="pdf-result-section"><div class="pdf-cost-title">Hiring Professionals: Annual Total Cost</div><div class="pdf-cost-value">${professionalTotalCost}</div></div>
                    <div class="pdf-result-section"><div class="pdf-cost-title">DIY: Annual Total Cost (Equipment + Operations)</div><div class="pdf-cost-value">${diyTotalCost}</div></div>
                    <div class="pdf-section-title">Summary</div>
                    <div class="pdf-summary">${summaryText}</div>
                    ${recommendationText ? `<div class="pdf-section-title">Recommendation</div><div class="pdf-recommendation">${recommendationText}</div>` : ''}
                </div>
            </body>
            </html>
        `;
    }

    /**
     * Saves the generated PDF content.
     */
    function saveAsPDF() {
        const pdfContent = getPdfContent();
        const pdfButton = document.getElementById('savePdfBtn');
        const calculateButton = document.querySelector('.calculate-btn');
        const body = document.body;
        body.classList.add('generating-pdf'); // Add class to hide main content

        // Temporarily hide buttons
        pdfButton.style.display = 'none';
        calculateButton.style.display = 'none';

        const options = {
            margin:       0.5,
            filename:     'TCO_Analysis_Results.pdf',
            image:        { type: 'jpeg', quality: 0.98 },
            html2canvas:  { scale: 2, useCORS: true },
            jsPDF:        { unit: 'in', format: 'letter', orientation: 'portrait' }
        };

        html2pdf().from(pdfContent).set(options).save().then(() => {
            // Show buttons and remove class after saving
            pdfButton.style.display = 'block';
            calculateButton.style.display = 'block';
            body.classList.remove('generating-pdf');
        });
    }
</script>

</body>
</html>
